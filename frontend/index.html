<!doctype html>
<html lang="kk">
<head>
Â  Â  <meta charset="utf-8" />
Â  Â  <title>ğŸ¤– AI Math Quest â€” ÒšĞ°Ğ·Ğ°Ò›ÑˆĞ° Ğ½Ò±ÑÒ›Ğ° + Ğ¢Ğ°Ğ¹Ğ¼ĞµÑ€</title>
Â  Â  <style>
Â  Â  Â  Â  body{font-family:'Segoe UI',sans-serif;background:linear-gradient(135deg,#e2ebf0,#cfd9df);
Â  Â  Â  Â  Â  Â  color:#222;text-align:center;padding:20px;transition:background .3s ease}
Â  Â  Â  Â  .card{background:#fff;padding:18px;border-radius:16px;
Â  Â  Â  Â  Â  Â  box-shadow:0 6px 18px rgba(0,0,0,.1);width:420px;margin:20px auto;
Â  Â  Â  Â  Â  Â  transition:transform .3s ease,box-shadow .3s ease}
Â  Â  Â  Â  .card:hover{transform:scale(1.02);box-shadow:0 8px 24px rgba(0,0,0,.15)}
Â  Â  Â  Â  input{padding:10px;border-radius:8px;border:1px solid #ccc;width:80%;margin:10px 0;
Â  Â  Â  Â  Â  Â  text-align:center;font-size:16px}
Â  Â  Â  Â  button{padding:10px 14px;border-radius:8px;margin:6px;cursor:pointer;border:none;
Â  Â  Â  Â  Â  Â  font-size:15px;background:#4CAF50;color:#fff;transition:background .2s}
Â  Â  Â  Â  button:hover{background:#3e8e41}
Â  Â  Â  Â  #progress{height:20px;background:#4caf50;border-radius:12px;width:0;color:#fff;
Â  Â  Â  Â  Â  Â  line-height:20px;transition:width .3s}
Â  Â  Â  Â  #feedback{font-size:18px;font-weight:bold;margin-top:10px;min-height:30px;
Â  Â  Â  Â  Â  Â  transition:color .3s,transform .3s}
Â  Â  Â  Â  .mute-btn{position:fixed;top:10px;right:10px;background:#2196F3;border-radius:50%;
Â  Â  Â  Â  Â  Â  width:40px;height:40px;color:white;font-size:18px}
Â  Â  Â  Â  #timer{font-weight:bold;font-size:18px;color:#ff5722;margin:10px 0;}
Â  Â  </style>
</head>
<body>
<h1>ğŸ¤– AI Math Quest (ÒšĞ°Ğ·Ğ°Ò›ÑˆĞ°)</h1>
<button class="mute-btn" id="muteBtn">ğŸ”Š</button>

<div id="login" class="card">
Â  Â  <label>ĞÑ‚Ñ‹Ò£Ñ‹Ğ·Ğ´Ñ‹ ĞµĞ½Ğ³Ñ–Ğ·Ñ–Ò£Ñ–Ğ·:</label><br/>
Â  Â  <input id="playerName" placeholder="ĞĞ¹Ñ‹Ğ½ÑˆÑ‹" /><br/>
Â  Â  <button id="startBtn">Ğ‘Ğ°ÑÑ‚Ğ°Ñƒ</button>
</div>

<div id="game" class="card" style="display:none">
Â  Â  <div>ĞĞ¹Ñ‹Ğ½ÑˆÑ‹: <b id="playerLabel"></b></div>
Â  Â  <div>Ğ”ĞµÒ£Ğ³ĞµĞ¹: <b id="levelLabel">1</b> | Ò°Ğ¿Ğ°Ğ¹: <b id="scoreLabel">0</b></div>
Â  Â  <div id="timer">â±ï¸ 15 ÑĞµĞºÑƒĞ½Ğ´</div>
Â  Â  <div style="background:#ddd;padding:3px;border-radius:12px;margin:10px 0">
Â  Â  Â  Â  <div id="progress">0%</div>
Â  Â  </div>

Â  Â  <p id="question">Ğ¡Ò±Ñ€Ğ°Ò›...</p>
Â  Â  <input id="answerInput" type="number" step="any" placeholder="Ğ–Ğ°ÑƒĞ°Ğ±Ñ‹Ò£Ñ‹Ğ·Ğ´Ñ‹ Ğ¶Ğ°Ğ·Ñ‹Ò£Ñ‹Ğ·" /><br/>
Â  Â  <button id="submitBtn">Ğ–Ğ°ÑƒĞ°Ğ¿ Ğ±ĞµÑ€Ñƒ</button>
Â  Â  <button id="hintBtn">ĞšĞµÒ£ĞµÑ (-5 Ò±Ğ¿Ğ°Ğ¹)</button>

Â  Â  <p id="feedback"></p>
Â  Â  <h3>ğŸ† ĞšÓ©ÑˆĞ±Ğ°ÑÑˆÑ‹Ğ»Ğ°Ñ€</h3>
Â  Â  <ol id="leaders"></ol>
</div>

<script>
// Ğ¢Ò®Ğ—Ğ•Ğ¢Ğ£: API Ğ¼ĞµĞºĞµĞ½Ğ¶Ğ°Ğ¹Ñ‹Ğ½ Render-Ğ´Ğµ Ğ¶Ò±Ğ¼Ñ‹Ñ Ñ–ÑÑ‚ĞµÑƒ Ò¯ÑˆÑ–Ğ½ Ò›Ğ°Ñ‚Ñ‹ÑÑ‚Ñ‹ Ğ¶Ğ¾Ğ»Ò“Ğ° (relative path) Ó©Ğ·Ğ³ĞµÑ€Ñ‚Ñ‚Ñ–Ğº
const API="";Â 
let player=null,currentQuestion=null,hintUsed=false,muted=false;
let timeLeft=15,timerInterval=null;

// ğŸµ Ğ”Ñ‹Ğ±Ñ‹ÑÑ‚Ğ°Ñ€
const correctSound=new Audio("sounds/correct.mp3");
const wrongSound=new Audio("sounds/wrong.mp3");
const comboSound=new Audio("sounds/combo.mp3");
const bgMusic=new Audio("sounds/bg.mp3");
bgMusic.loop=true;bgMusic.volume=0.3;

document.getElementById('muteBtn').onclick=()=>{
Â  Â  muted=!muted;
Â  Â  document.getElementById('muteBtn').innerText=muted?"ğŸ”ˆ":"ğŸ”Š";
Â  Â  [correctSound,wrongSound,comboSound,bgMusic].forEach(a=>a.muted=muted);
};

const el={
Â  Â  login:document.getElementById('login'),
Â  Â  playerName:document.getElementById('playerName'),
Â  Â  startBtn:document.getElementById('startBtn'),
Â  Â  game:document.getElementById('game'),
Â  Â  playerLabel:document.getElementById('playerLabel'),
Â  Â  question:document.getElementById('question'),
Â  Â  answerInput:document.getElementById('answerInput'),
Â  Â  submitBtn:document.getElementById('submitBtn'),
Â  Â  feedback:document.getElementById('feedback'),
Â  Â  scoreLabel:document.getElementById('scoreLabel'),
Â  Â  levelLabel:document.getElementById('levelLabel'),
Â  Â  progress:document.getElementById('progress'),
Â  Â  leaders:document.getElementById('leaders'),
Â  Â  hintBtn:document.getElementById('hintBtn'),
Â  Â  timer:document.getElementById('timer')
};

// ğŸš€ ĞĞ¹Ñ‹Ğ½Ğ´Ñ‹ Ğ±Ğ°ÑÑ‚Ğ°Ñƒ
el.startBtn.onclick=async()=>{
Â  Â  player=el.playerName.value.trim()||"ĞĞ¹Ñ‹Ğ½ÑˆÑ‹";
Â  Â  // API Ğ°Ğ¹Ğ½Ñ‹Ğ¼Ğ°Ğ»Ñ‹ÑÑ‹ Ğ±Ğ¾Ñ Ğ±Ğ¾Ğ»Ò“Ğ°Ğ½Ğ´Ñ‹Ò›Ñ‚Ğ°Ğ½, Ğ¾Ğ» Ò›Ğ°Ğ·Ñ–Ñ€Ğ³Ñ– Ğ´Ğ¾Ğ¼ĞµĞ½Ğ´Ñ– (Render URL) Ò›Ğ¾Ğ»Ğ´Ğ°Ğ½Ğ°Ğ´Ñ‹.
Â  Â  const res=await fetch(`${API}/register/${encodeURIComponent(player)}`);Â 
Â  Â  const data=await res.json();
Â  Â  el.playerLabel.innerText=player;
    
    // âœ… Ğ¢Ò®Ğ—Ğ•Ğ¢Ğ£: 2-Ğ‘Ó¨Ğ›Ğ†Ğœ (A) â€” API ĞºÑ–Ğ»Ñ‚Ñ‚ĞµÑ€Ñ– Ğ¶Ğ°Ò£Ğ°Ñ€Ñ‚Ñ‹Ğ»Ğ´Ñ‹
Â  Â  el.scoreLabel.innerText=data.current_score||0; // Score ĞºÑ–Ğ»Ñ‚Ñ–Ğ½ Ñ‚ĞµĞºÑĞµÑ€Ñ–Ò£Ñ–Ğ·
Â  Â  el.levelLabel.innerText=data.current_level||1; // Level ĞºÑ–Ğ»Ñ‚Ñ–Ğ½ Ñ‚ĞµĞºÑĞµÑ€Ñ–Ò£Ñ–Ğ·

Â  Â  el.login.style.display="none";
Â  Â  el.game.style.display="block";
Â  Â  if(!muted)bgMusic.play().catch(()=>{});
Â  Â  getQuestion();
Â  Â  updateLeaderboard();
};

// ğŸ”¢ Ğ¡Ò±Ñ€Ğ°Ò› Ğ°Ğ»Ñƒ
async function getQuestion(){
Â  Â  clearInterval(timerInterval);
Â  Â  timeLeft=15;
Â  Â  updateTimer();
Â  Â  timerInterval=setInterval(()=>{
Â  Â  Â  Â  timeLeft--;
Â  Â  Â  Â  updateTimer();
Â  Â  Â  Â  if(timeLeft<=0){
Â  Â  Â  Â  Â  Â  clearInterval(timerInterval);
Â  Â  Â  Â  Â  Â  el.feedback.style.color="red";
Â  Â  Â  Â  Â  Â  el.feedback.innerText="â° Ğ£Ğ°Ò›Ñ‹Ñ‚ Ğ±Ñ–Ñ‚Ñ‚Ñ–!";
Â  Â  Â  Â  Â  Â  if(!muted)wrongSound.play();
Â  Â  Â  Â  Â  Â  sendAnswer(NaN,true); // ÑƒĞ°Ò›Ñ‹Ñ‚ Ğ±Ñ–Ñ‚ĞºĞµĞ½
Â  Â  Â  Â  }
Â  Â  },1000);

Â  Â  const res=await fetch(`${API}/question/${encodeURIComponent(player)}`);
Â  Â  const data=await res.json();
    
    // âœ… Ğ¢Ò®Ğ—Ğ•Ğ¢Ğ£: 2-Ğ‘Ó¨Ğ›Ğ†Ğœ (B) â€” API ĞºÑ–Ğ»Ñ‚Ñ‚ĞµÑ€Ñ– Ğ¶Ğ°Ò£Ğ°Ñ€Ñ‚Ñ‹Ğ»Ğ´Ñ‹
Â  Â  currentQuestion=data.math_question; // Ğ¡Ò±Ñ€Ğ°Ò›Ñ‚Ñ‹Ò£ ĞºÑ–Ğ»Ñ‚Ñ–Ğ½ Ñ‚ĞµĞºÑĞµÑ€Ñ–Ò£Ñ–Ğ·
Â  Â  el.question.innerText=`(${data.current_level}-Ğ´ĞµÒ£Ğ³ĞµĞ¹) ${currentQuestion}`; // Level ĞºÑ–Ğ»Ñ‚Ñ–Ğ½ Ñ‚ĞµĞºÑĞµÑ€Ñ–Ò£Ñ–Ğ·

Â  Â  el.feedback.innerText="";
Â  Â  el.answerInput.value="";
}

// â±ï¸ Ğ¢Ğ°Ğ¹Ğ¼ĞµÑ€ Ğ¶Ğ°Ò£Ğ°Ñ€Ñ‚Ñƒ
function updateTimer(){
Â  Â  el.timer.innerText=`â±ï¸ ${timeLeft} ÑĞµĞºÑƒĞ½Ğ´`;
Â  Â  if(timeLeft<=5) el.timer.style.color="red";
Â  Â  else el.timer.style.color="#ff5722";
}

// âœ… Ğ–Ğ°ÑƒĞ°Ğ¿ Ğ±ĞµÑ€Ñƒ
el.submitBtn.onclick=()=>sendAnswer(parseFloat(el.answerInput.value),false);

async function sendAnswer(val,isTimeout){
Â  Â  clearInterval(timerInterval);
Â  Â  if(isTimeout){
Â  Â  Â  Â  val=-9999; // ÑƒĞ°Ò›Ñ‹Ñ‚ Ğ±Ñ–Ñ‚ÑĞµ, Ğ¶Ğ°ÑƒĞ°Ğ¿ Ò›Ğ°Ñ‚Ğµ
Â  Â  }else if(isNaN(val)){
Â  Â  Â  Â  alert("Ğ–Ğ°ÑƒĞ°Ğ¿Ñ‚Ñ‹ ĞµĞ½Ğ³Ñ–Ğ·Ñ–Ò£Ñ–Ğ·!");
Â  Â  Â  Â  getQuestion();
Â  Â  Â  Â  return;
Â  Â  }
Â  Â  const payload={player,question:currentQuestion,user_answer:val};
Â  Â  const res=await fetch(`${API}/answer`,{
Â  Â  Â  Â  method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)
Â  Â  });
Â  Â  const data=await res.json();
Â  Â  if(data.is_correct){
Â  Â  Â  Â  el.feedback.style.color="green";
Â  Â  Â  Â  el.feedback.innerText="âœ… Ğ”Ò±Ñ€Ñ‹Ñ! Ğ–Ğ°Ñ€Ğ°Ğ¹ÑÑ‹Ò£!";
Â  Â  Â  Â  if(!muted)correctSound.play();
Â  Â  }else{
Â  Â  Â  Â  el.feedback.style.color="red";
Â  Â  Â  Â  el.feedback.innerText=`âŒ ÒšĞ°Ñ‚Ğµ! Ğ”Ò±Ñ€Ñ‹Ñ Ğ¶Ğ°ÑƒĞ°Ğ¿: ${data.correct_answer}`;
Â  Â  Â  Â  if(!muted)wrongSound.play();
Â  Â  }
Â  Â  el.scoreLabel.innerText=data.score;
Â  Â  el.levelLabel.innerText=data.new_level;
Â  Â  el.progress.style.width=data.progress+"%";
Â  Â  el.progress.innerText=data.progress+"%";
Â  Â  setTimeout(getQuestion,2000);
}

// ğŸ’¡ ĞšĞµÒ£ĞµÑ
el.hintBtn.onclick=()=>{
Â  Â  const score=parseInt(el.scoreLabel.innerText)||0;
Â  Â  if(score<5)return alert("Ò°Ğ¿Ğ°Ğ¹ Ğ¶ĞµÑ‚ĞºÑ–Ğ»Ñ–ĞºÑÑ–Ğ·!");
Â  Â  if(hintUsed)return alert("Ğ‘Ò±Ñ€Ñ‹Ğ½ Ò›Ğ¾Ğ»Ğ´Ğ°Ğ½Ñ‹Ğ»Ğ´Ñ‹!");
Â  Â  hintUsed=true;
Â  Â  el.feedback.innerText="ğŸ’¡ ĞšĞµÒ£ĞµÑ: Ğ°Ğ¼Ğ°Ğ»Ò“Ğ° Ğ¼Ò±Ò›Ğ¸ÑÑ‚ Ò›Ğ°Ñ€Ğ°!";
Â  Â  el.feedback.style.color="blue";
Â  Â  el.scoreLabel.innerText=Math.max(score-5,0);
};

// ğŸ† ĞšÓ©ÑˆĞ±Ğ°ÑÑˆÑ‹Ğ»Ğ°Ñ€
async function updateLeaderboard(){
Â  Â  const res=await fetch(`${API}/leaderboard`);
Â  Â  const data=await res.json();
Â  Â  el.leaders.innerHTML='';
Â  Â  data.slice(0,10).forEach(p=>{
Â  Â  Â  Â  const li=document.createElement('li');
Â  Â  Â  Â  li.innerText=`${p.player}: ${p.score}`;
Â  Â  Â  Â  el.leaders.appendChild(li);
Â  Â  });
}
setInterval(updateLeaderboard,5000);
</script>
</body>
</html>


